<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.6.xsd">

    <changeSet id="init db" author="author name">
        <sql>
            CREATE TABLE IF NOT EXISTS "user" (
            id BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
            email VARCHAR(20) NOT NULL,
            login VARCHAR(15) UNIQUE NOT NULL,
            user_password VARCHAR(72) NOT NULL
            );

            CREATE TABLE IF NOT EXISTS user_roles (
            id BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
            role_name VARCHAR(15) UNIQUE NOT NULL
            );

            CREATE TABLE IF NOT EXISTS users_user_roles (
            user_id BIGINT,
            user_role_id BIGINT,
            FOREIGN KEY (user_id) REFERENCES "user" (id) ON UPDATE CASCADE ON DELETE CASCADE,
            FOREIGN KEY (user_role_id) REFERENCES user_roles (id) ON UPDATE CASCADE ON DELETE CASCADE,
            CONSTRAINT user_user_role_pk PRIMARY KEY (user_id, user_role_id)
            );

        </sql>
    </changeSet>
</databaseChangeLog>